# A playground

ninja_required_version = 1.4

# Arguments passed to gen.sh; used when regenerating this file.
gen_args =
common_dir = .

include $common_dir/common.ninja

name = main
mode = 🐋 $

docker_prefix = docker run
docker_flags  = -v $$(realpath .):/opt/ -t
docker_cntnr  = rrbutani/arm-llvm-toolchain

cc_opt_level  = $cc_opt_debug
lto_opt_level = $lto_opt_debug

build $builddir/debug/objs/startup.o: cc src/startup.c
build $builddir/debug/objs/main.o: cc src/main.c
build $builddir/debug/objs/intrinsics.o: as asm/intrinsics.s

build $builddir/debug/$name.out: link $
  $builddir/debug/objs/startup.o $
  $builddir/debug/objs/main.o $
  $builddir/debug/objs/intrinsics.o

#build $builddir/debug/$name.axf:

build build: phony $builddir/debug/$name.out

cc_opt_level  = $cc_opt_release
lto_opt_level = $lto_opt_release

build $builddir/release/objs/startup.o: cc src/startup.c
build $builddir/release/objs/main.o: cc src/main.c
build $builddir/release/objs/intrinsics.o: as asm/intrinsics.s

build $builddir/release/$name.out: link $
  $builddir/release/objs/startup.o $
  $builddir/release/objs/main.o $
  $builddir/release/objs/intrinsics.o

build build-release: phony $builddir/release/$name.out

build clean: rm $builddir

build graph.png: graph
build graph: phony graph.png

default build
